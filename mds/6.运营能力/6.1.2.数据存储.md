<h2 align="center">数据存储</h2>
<p>
游戏服务器所需的各种数据存储系统的维护。
</p>

**关键词:**<br/> 
*数据存储,SQL,Redis,MemCache,MongoDB,备份,恢复,数据对象,缓存数据库,MySQL,MSSQL,关系数据库,非关系数据库,NoSQL,集群,数据迁移,云内数据迁移,跨境数据迁移,跨云数据迁移,日志查询,数据统计分析,数据回档,持久化,高可用性,副本集,分片集群,权限管理,编码问题,主从复制,读写分离,ACID,字符编码,增量迁移,双写,全量备份,增量备份,定时备份*

**标签:**<br/>
*等级: 中级, 阶段: 运营, 分类: 运营能力, 角色: 运维|服务端开发*

## 图谱
![图片加载中...](../../exports/6.1.2.数据存储.png?raw=true)

## 子主题

### 数据对象

**是做什么的？在哪用？**

- **作用**：提供静态数据存储
- **应用场景**：存储游戏热更数据等静态配置数据

**要点和思考方向**

- 主要用于存储不需要频繁修改的静态数据
- 适合游戏配置、热更资源等场景

### 缓存数据库

**是做什么的？在哪用？**

- **作用**：
  - 让数据操作更高效
  - 让内存使用更可控
- **应用场景**：对数据IO性能要求比较高的业务，因为缓存数据库是将数据存储到内存，读写速度远快于磁盘数据库

**会遇到哪些问题？用什么解决？**

- **问题**：内存容量限制、数据持久化、高可用性
- **解决方案**：
  - 使用集群模式扩展容量和提升可用性
  - 根据业务需求选择合适的缓存策略（持久化或仅内存）

**要点和思考方向**

- **候选方案**：
  - **Redis**：功能丰富，支持多种数据结构，支持持久化
  - **MemCache**：简单高效，纯内存缓存
- 缓存数据库适合热点数据、频繁读写的数据
- 需要考虑集群配置以支持高并发和高可用

### MongoDB

**是做什么的？在哪用？**

- **类型**：非关系型数据库（NoSQL）
- **应用场景**：适合存储非结构化或半结构化数据，如游戏日志、玩家行为数据等

**会遇到哪些问题？用什么解决？**

- **问题**：数据一致性、查询性能、权限管理、编码问题、高可用性
- **解决方案**：
  - 配置合适的集群模式（副本集、分片集群）
  - 设置合理的权限控制
  - 注意字符编码配置（UTF-8等）
  - 优化查询参数和索引

**要点和思考方向**

- MongoDB适合灵活的数据结构，不需要严格的表结构
- 需要关注集群配置、权限管理、编码设置等运维事项
- 适合游戏中的日志存储、玩家数据等场景

### MySQL

**是做什么的？在哪用？**

- **类型**：关系数据库（SQL）
- **应用场景**：游戏核心数据存储，如玩家账号、角色数据、道具数据等需要强一致性的数据

**会遇到哪些问题？用什么解决？**

- **问题**：性能瓶颈、数据一致性、权限管理、编码问题、高可用性
- **解决方案**：
  - 配置主从复制、读写分离
  - 使用集群模式（主从、主主等）
  - 设置合理的权限控制
  - 注意字符编码配置
  - 优化SQL查询和索引

**要点和思考方向**

- MySQL适合需要ACID特性、强一致性的核心业务数据
- 需要关注集群配置、权限管理、编码设置、参数调优等运维事项
- 是游戏服务器最常用的关系型数据库

### MSSQL

**是做什么的？在哪用？**

- **类型**：关系数据库（SQL）
- **应用场景**：Windows环境下的数据库选择，适合.NET技术栈的游戏服务器

**要点和思考方向**

- Microsoft SQL Server，主要运行在Windows平台
- 适合使用.NET技术栈的游戏项目
- 功能与MySQL类似，但生态和部署环境不同

### 通用事项

**是做什么的？在哪用？**

- **数据迁移**：
  - 云内数据迁移
  - 跨境数据迁移
  - 跨云数据迁移
- **备份/恢复**：定期备份数据，确保数据安全，支持快速恢复
- **日志查询**：查询数据库操作日志，用于问题排查和审计
- **数据统计分析**：对数据库中的数据进行统计分析，支持运营决策
- **数据回档**：归档至任意时间点，支持数据恢复和问题排查

**会遇到哪些问题？用什么解决？**

- **迁移问题**：
  - 数据量大、迁移时间长
  - 跨地域、跨云迁移网络问题
  - 迁移过程中服务中断
- **备份问题**：
  - 备份策略不当导致数据丢失风险
  - 备份文件过大、存储成本高
  - 恢复时间长影响业务
- **解决方案**：
  - 制定合理的迁移计划，使用增量迁移、双写等方式减少中断
  - 制定备份策略（全量备份、增量备份、定时备份）
  - 定期测试恢复流程，确保备份可用
  - 使用云服务商提供的数据迁移和备份工具

**要点和思考方向**

- **数据迁移**：需要考虑迁移时间窗口、数据一致性、服务可用性
- **备份/恢复**：是数据安全的重要保障，需要定期验证备份的有效性
- **日志查询**：有助于问题排查和性能分析
- **数据统计分析**：支持运营数据分析和决策
- **数据回档**：支持恢复到任意时间点，是处理数据问题的最后手段
