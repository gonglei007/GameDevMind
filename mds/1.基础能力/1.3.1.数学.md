<h2 align="center">数学</h2>
<p>
游戏开发中的很多地方都会用到数学，比如图形、物理、声音、数值、概率等等。
</p>

**关键词:**<br/>
*向量,矩阵,三角函数,对数,几何,随机,点乘,叉乘,斐波那契数列,欧拉角,四元数,Noise,傅里叶变换*

**标签:**<br/>
*等级: 初级|中级, 阶段: 学习|开发, 分类: 基础能力, 角色: 客户端开发|美术*

----
## 几何与线性代数

### 坐标

### 是什么？在哪用？

- **作用**：表示空间中点的位置
- **应用场景**：
  - 3D图形渲染
  - 物理模拟
  - 游戏对象定位
- **类型**：
  - **齐次坐标**：用于表示点和方向，便于矩阵运算
  - **笛卡尔坐标**：最常用的坐标系统
  - **极坐标**：用距离和角度表示位置

### 会遇到哪些问题？用什么解决？

- **坐标系差异**
  - **问题**：坐标系分左手坐标系和右手坐标系，不同的引擎、工具可能会采用不同的坐标系
  - **解决方向**：
    - 进行坐标系转换
    - 使用矩阵转置转换
    - 统一使用一种坐标系
    - 在导入导出时进行转换

- **坐标精度问题**
  - **问题**：浮点数精度可能导致坐标计算误差
  - **解决方向**：
    - 使用双精度浮点数（如果必要）
    - 使用定点数（如果适用）
    - 注意浮点数比较，使用epsilon值
    - 避免累积误差

### 要点和思考方向

- 理解不同坐标系的特点和转换方法
- 注意浮点数精度问题
- 统一坐标系，减少转换开销

### 向量

### 是什么？在哪用？

- **作用**：表示方向和大小，是游戏开发中最常用的数学工具
- **应用场景**：
  - 位置和方向计算
  - 物理模拟（力、速度、加速度）
  - 图形渲染（法线、切线）
  - 碰撞检测
  - AI寻路

### 向量运算

- **向量加法和减法**
  - **应用举例**：力的叠加、位置移动

- **标量与向量相乘**：缩放向量

- **法线**：垂直于表面的向量，用于光照计算

- **切线**
  - **应用举例**：通过两个点的切线，判断一个曲线的上行、下行拐点

- **点乘**
  - **应用**：计算两个向量的夹角、投影
  - **应用举例**：
    - 地形编辑器中的平滑笔刷，需要先算两个面之间的夹角，再决定如何平滑
    - 通过计算NPC的正向视野来判断是否能看到目标
    - 判断物体是否在视野范围内

- **叉乘**
  - **应用**：
    - 计算一个面的法向
    - 计算"左侧"或"右侧"的方向
  - **应用举例**：求一个面的垂直方向、判断点的左右关系

- **向量标准化**
  - **应用**：
    - 获取一个向量的标准向量，让其它向量跟它运算的时候只有其"方向"起作用
    - **举例**：获取玩家角色对目标角色的方向的向量，在这个方向上算加速度，这时候就可以考虑先标准化，再乘上加速度标量

### 会遇到哪些问题？用什么解决？

- **零向量问题**
  - **问题**：零向量无法标准化，可能导致除零错误
  - **解决方向**：
    - 标准化前检查向量长度
    - 使用安全的标准化函数
    - 处理零向量的特殊情况

- **向量精度问题**
  - **问题**：浮点数计算可能导致向量不准确
  - **解决方向**：
    - 使用epsilon值比较向量
    - 定期重新标准化向量
    - 注意累积误差

- **性能问题**
  - **问题**：大量向量运算可能影响性能
  - **解决方向**：
    - 使用SIMD指令优化
    - 批量处理向量运算
    - 缓存计算结果
    - 使用数学库的优化实现

### 要点和思考方向

- 向量是游戏开发的基础工具，掌握向量运算很重要
- 注意零向量和精度问题
- 使用数学库的优化实现提高性能
- 理解点乘和叉乘的几何意义

### 欧拉角

### 是什么？在哪用？

- **作用**：用三个角度表示3D旋转，直观易懂
- **应用场景**：
  - 第一人称视角摄像机控制
  - 物体相对于自身轴的旋转
  - 简单的旋转表示
- **角度**：
  - **Roll**：翻滚角（绕Z轴）
  - **Pitch**：俯仰角（绕X轴）
  - **Yaw**：偏航角（绕Y轴）

### 会遇到哪些问题？用什么解决？

- **万向锁（Gimbal Lock）**
  - **问题**：某些角度组合会导致失去一个自由度
  - **解决方向**：
    - 使用四元数替代欧拉角
    - 限制角度范围
    - 使用轴角表示法

- **角度插值问题**
  - **问题**：欧拉角插值可能不自然
  - **解决方向**：
    - 使用四元数进行插值
    - 处理角度环绕（0°和360°）
    - 使用球面线性插值（SLERP）

### 要点和思考方向

- 欧拉角直观易懂，但存在万向锁问题
- 复杂旋转使用四元数更稳定
- 注意角度范围和插值问题

### 四元数

### 是什么？在哪用？

- **作用**：用四个数表示3D旋转，避免万向锁问题
- **应用场景**：
  - 3D旋转计算
  - 旋转插值（SLERP）
  - 复杂旋转组合
  - 骨骼动画
- **优势**：比欧拉角更稳定，插值更自然

### 会遇到哪些问题？用什么解决？

- **理解困难**
  - **问题**：四元数概念抽象，难以理解
  - **解决方向**：
    - 使用数学库封装，不需要理解内部实现
    - 理解基本操作（乘法、插值）
    - 参考文档和示例

- **转换问题**
  - **问题**：四元数与欧拉角、矩阵之间的转换
  - **解决方向**：
    - 使用数学库的转换函数
    - 注意转换的精度和范围
    - 统一使用一种表示方式（如果可能）

- **性能考虑**
  - **问题**：四元数运算可能比矩阵慢
  - **解决方向**：
    - 使用优化的数学库
    - 缓存旋转结果
    - 在性能关键路径上考虑使用矩阵

### 要点和思考方向

- 四元数适合复杂旋转，避免万向锁
- 使用数学库，不需要深入理解数学原理
- 注意与欧拉角、矩阵的转换
- 旋转插值使用SLERP

### 矩阵运算

### 是什么？在哪用？

- **作用**：用于表示和计算变换（平移、旋转、缩放）
- **应用场景**：
  - 3D图形变换
  - 坐标系统转换
  - 视图和投影变换
  - 骨骼动画

### 矩阵运算类型

- **矩阵的加减运算**：基本的矩阵运算

- **矩阵乘法**
  - **应用举例**：
    - **平移**：通过矩阵乘法实现位置变换
    - **旋转**：通过矩阵乘法实现旋转变换
    - **缩放**：通过矩阵乘法实现缩放变换
    - **组合变换**：将多个变换组合成一个矩阵

- **矩阵转置**
  - **应用举例**：左右手坐标系数据的转换

- **矩阵求逆**
  - **应用**：反向变换、坐标转换

### 会遇到哪些问题？用什么解决？

- **矩阵乘法顺序**
  - **问题**：矩阵乘法不满足交换律，顺序很重要
  - **解决方向**：
    - 理解矩阵乘法的顺序（从右到左）
    - 使用变换矩阵的约定顺序
    - 使用数学库的标准实现

- **性能问题**
  - **问题**：矩阵运算可能影响性能
  - **解决方向**：
    - 使用SIMD指令优化
    - 使用数学库的优化实现
    - 缓存变换矩阵
    - 避免不必要的矩阵运算

- **精度问题**
  - **问题**：浮点数精度可能导致矩阵不准确
  - **解决方向**：
    - 定期重新计算矩阵
    - 使用双精度（如果必要）
    - 注意矩阵的累积误差

### 要点和思考方向

- 矩阵是3D变换的基础工具
- 注意矩阵乘法的顺序
- 使用数学库的优化实现
- 理解变换矩阵的组合方式

### 曲线

### 是什么？在哪用？

- **作用**：生成平滑的路径和动画曲线
- **应用场景**：
  - 路径规划
  - 动画曲线
  - UI动画
  - 地形生成

### 贝塞尔曲线

### 是什么？在哪用？

- **作用**：通过控制点生成平滑曲线
- **应用场景**：
  - 路径生成
  - 动画缓动
  - UI设计
  - **应用举例**：赛车游戏中自动生成一段赛道，选择几个拐点，然后就可以用贝塞尔曲线来生成赛道的路径了

### 会遇到哪些问题？用什么解决？

- **控制点选择**
  - **问题**：如何选择合适的控制点？
  - **解决方向**：
    - 使用可视化工具调整
    - 理解贝塞尔曲线的数学原理
    - 使用预设的曲线模板

- **性能问题**
  - **问题**：实时计算曲线可能影响性能
  - **解决方向**：
    - 预计算曲线点
    - 使用查找表
    - 优化曲线计算算法

### 要点和思考方向

- 贝塞尔曲线适合生成平滑路径
- 使用可视化工具调整控制点
- 预计算曲线点提高性能

## 代数

### 三角函数

### 是什么？在哪用？

- **作用**：处理角度和周期性变化
- **应用场景**：
  - 周期性动画（波浪、摆动）
  - 角度计算
  - 圆形运动
  - 波形生成

### 函数类型

- **sin（正弦）**
  - **应用举例**：模拟波的效果，比如波浪、水面动画

- **cos（余弦）**
  - **应用举例**：求夹角、圆形运动

- **tan（正切）**
  - **应用举例**：求切线、斜率计算

### 会遇到哪些问题？用什么解决？

- **性能问题**
  - **问题**：三角函数计算可能较慢
  - **解决方向**：
    - 使用查找表（LUT）
    - 预计算常用角度
    - 使用近似函数（如果精度允许）
    - 使用数学库的优化实现

- **角度单位**
  - **问题**：角度单位（度/弧度）混淆
  - **解决方向**：
    - 统一使用弧度（数学库标准）
    - 提供转换函数
    - 明确标注角度单位

### 要点和思考方向

- 三角函数适合周期性动画和角度计算
- 注意角度单位（度/弧度）
- 使用查找表优化性能
- 理解三角函数的周期性

### 对数

### 是什么？在哪用？

- **作用**：实现非线性变化，让变化率逐渐变慢
- **应用场景**：
  - 声音衰减
  - 摄像机跟随
  - 经验值曲线
  - 缩放动画

### 会遇到哪些问题？用什么解决？

- **参数选择**
  - **问题**：如何选择合适的对数底数？
  - **解决方向**：
    - 使用自然对数（ln）或常用对数（log10）
    - 根据实际效果调整参数
    - 使用对数曲线编辑器

- **数值范围**
  - **问题**：对数的定义域限制（必须大于0）
  - **解决方向**：
    - 检查输入值范围
    - 使用安全的对数函数
    - 处理边界情况

### 要点和思考方向

- 对数适合实现非线性衰减和缩放
- 注意对数的定义域限制
- 根据实际效果调整参数

### 斐波那契数列（Fibonacci sequence）

### 是什么？在哪用？

- **作用**：提供自然的增长曲线，符合人类感知
- **应用场景**：
  - 数值设计（等级、属性）
  - 游戏平衡
  - 进度曲线
- **应用举例**：帮助策划设计数值的进阶

### 会遇到哪些问题？用什么解决？

- **增长过快**
  - **问题**：后期数值增长可能过快
  - **解决方向**：
    - 使用修正的斐波那契数列
    - 结合其他曲线（如对数）
    - 分段使用不同曲线

### 要点和思考方向

- 斐波那契数列提供自然的增长曲线
- 注意后期增长可能过快
- 适合用于游戏数值设计

### 递归

### 是什么？在哪用？

- **应用举例**：遍历文件目录

### 其它

### 是什么？在哪用？

- **绝对值（Abs）**：获取数值的绝对值

- **Floor**
  - **作用**：向下取整

- **Ceil**
  - **作用**：向上取整

## 概率论

### 随机

### 是什么？在哪用？

- **作用**：生成随机数，实现游戏中的随机事件
- **应用场景**：
  - 掉落系统
  - AI决策
  - 地图生成
  - 数值波动

### 正态分布

### 是什么？在哪用？

- **作用**：模拟真实世界的数据分布，符合自然规律
- **应用场景**：
  - 玩家属性分布
  - AI行为模拟
  - 数值波动
- **应用**：
  - 可以用来帮助游戏设计者更准确地确定游戏中的随机变量，比如游戏的武器使用率、掉落率、玩家技能分布、玩家等级分布等
  - 可以用来预测AI模型的行为，使其能够更准确地模拟真实世界中的行为
  - 可以帮助游戏开发者确定动画曲线、物理效果、物体相互作用等

### 会遇到哪些问题？用什么解决？

- **如何生成更"可控的"随机？**
  - **问题**：即随机比较准确的符合分布概率
  - **解决方向**：
    - 使用Shuffle Bag算法
    - 使用加权随机
    - 使用伪随机数生成器（PRNG）
    - 使用种子控制随机序列

- **随机性不足**
  - **问题**：伪随机可能不够随机
  - **解决方向**：
    - 使用更好的随机数生成器
    - 使用真随机数（如果适用）
    - 定期重新种子

- **可预测性**
  - **问题**：某些场景需要可预测的随机（如回放）
  - **解决方向**：
    - 使用种子保存随机状态
    - 使用确定性随机数生成器
    - 记录随机数序列

### 要点和思考方向

- 随机是游戏设计的重要工具
- 使用合适的分布（均匀、正态等）
- 注意随机性的可控性
- 某些场景需要可预测的随机

### 应用

### 是什么？在哪用？

- **游戏的随机事件**
  - **概率分布**：控制随机事件的发生概率

- **游戏的AI决策**：基于概率的AI行为选择

- **游戏的赔率**
  - **概率分布**：计算游戏中的赔率和期望值

- **游戏的数据分析**
  - **假设检验**：验证游戏设计假设
  - **回归分析**：分析游戏数据之间的关系

## Noise

### 是什么？在哪用？

- **作用**：生成平滑的随机噪声，模拟自然效果
- **应用场景**：
  - 地形生成
  - 纹理生成
  - 云层效果
  - 程序化生成

### 类型

- **Perlin noise**：生成平滑的随机噪声，最常用
  - **Gradient Noise**：梯度噪声
  - **Value Noise**：值噪声
- **Simplex noise**：Perlin noise的改进版本，性能更好

### 会遇到哪些问题？用什么解决？

- **性能问题**
  - **问题**：Noise计算可能影响性能
  - **解决方向**：
    - 使用查找表预计算
    - 使用优化的Noise算法（如Simplex noise）
    - 分块生成，按需计算
    - 使用GPU计算（如果适用）

- **参数调优**
  - **问题**：如何调整Noise参数获得理想效果？
  - **解决方向**：
    - 使用可视化工具调整
    - 理解频率、振幅等参数
    - 使用多层Noise叠加
    - 参考示例和教程

### 要点和思考方向

- Noise适合程序化生成自然效果
- 使用多层Noise叠加获得复杂效果
- 注意性能优化，使用查找表或GPU
- 理解Noise参数对效果的影响

## 傅里叶变换

### 是什么？在哪用？

- **作用**：将信号从时域转换到频域，分析信号的频率特征
- **应用场景**：
  - 图像处理
  - 声音处理
  - 信号分析
  - 数据压缩

### 图像处理

### 是什么？在哪用？

- **作用**：处理游戏中的图像，提取特征、压缩数据等
- **应用场景**：
  - 图像特征提取
  - 抗锯齿
  - 图像压缩
  - 图像增强

### 应用

- **特征提取**：游戏中的图像通常是由像素组成的，傅里叶变换可以将这些像素转换成频率信息，从而提取出图像中的特征，比如轮廓、纹理、边缘等
  - 这些特征可以用来检测和识别图像中的物体，比如检测游戏中玩家的行为

- **抗锯齿和模糊问题**
  - **原理**：傅里叶变换可以将3D模型的曲面转换成频率信息，从而使更多的细节更加准确地显示出来，这就是抗锯齿的原理
  - **特点**：可以更快速地渲染模型，从而减少模糊的现象

- **图像压缩**：压缩图像数据

- **图像增强**：处理图片，消除噪点并增强图像质量

### 会遇到哪些问题？用什么解决？

- **计算复杂度**
  - **问题**：傅里叶变换计算复杂，可能影响性能
  - **解决方向**：
    - 使用快速傅里叶变换（FFT）
    - 使用GPU加速
    - 预计算或缓存结果
    - 降低采样率（如果精度允许）

### 要点和思考方向

- 傅里叶变换适合信号分析和处理
- 使用FFT提高性能
- 理解频域和时域的转换关系

### 声音处理

### 是什么？在哪用？

- **作用**：处理游戏中的声音，提取频率特征
- **应用场景**：
  - 音效处理
  - 音乐分析
  - 声音可视化
  - 音频压缩

### 应用

- **作用**：可以用来处理声音，比如游戏中的音乐和音效，它可以将声音信号转换成频率信息，从而提取出声音的特征，比如声音的频率、响度、音色等

- **应用举例**：可以根据声音特征来控制游戏中声音的大小、音色等

### 要点和思考方向

- 傅里叶变换适合声音的频率分析
- 使用FFT实时处理音频
- 理解频域特征对声音的影响

## 离散数学

### 是什么？在哪用？

- **作用**：处理离散的数学对象，解决游戏中的几何和逻辑问题
- **应用场景**：
  - 计算几何
  - 图论（寻路、网络）
  - 组合数学（概率、排列）
  - 逻辑推理（AI决策）

### 内容

- **离散数学**：处理离散对象的数学分支
- **计算几何**：解决几何问题的算法
- **抽象代数**：代数结构的研究
- **组合学**：排列组合、概率计算

### 应用举例

- **计算几何**：
  - 确定游戏中不同物体之间的位置关系
  - 计算游戏地图上每个像素在X、Y方向上的偏移量
  - 碰撞检测算法
  - 可见性判断

- **图论**：
  - 解决计算机网络中的路由问题
  - 实现远程游戏多人协作游戏
  - 寻路算法
  - 状态机设计

### 会遇到哪些问题？用什么解决？

- **算法复杂度**
  - **问题**：某些几何算法复杂度高
  - **解决方向**：
    - 使用空间分割（如BVH、四叉树）
    - 使用近似算法
    - 预计算常用结果
    - 使用成熟的几何库

### 要点和思考方向

- 离散数学是游戏开发的重要基础
- 使用成熟的算法和库
- 注意算法复杂度，优化性能
- 理解几何算法的原理和应用

## 更多资料
### 在线资料
* [Using Math to Develop Excellent Video Games](https://www.gamedesigning.org/learn/game-development-math/)
* [3D Math Primer for Graphics and Game Development](https://gamemath.com/book/intro.html)
* [Randomness and Game Design](https://www.gamedeveloper.com/design/randomness-and-game-design)
* [Perlin noise](https://www.scratchapixel.com/lessons/procedural-generation-virtual-worlds/perlin-noise-part-2/perlin-noise)
* [Noise Generation](https://www.gamedev.net/tutorials/programming/math-and-physics/noise-generation-r3793/)
* [Noise and Turbulence](https://mrl.cs.nyu.edu/~perlin/doc/oscar.html)
* [空间射线与三角形相交算法的两种实现](https://cloud.tencent.com/developer/article/1589424)
* [Tips from a combat designer: Fibonacci game design](https://www.gamedeveloper.com/design/tips-from-a-combat-designer-fibonacci-game-design)
* [Using Fibonacci for Game Balance](https://adamrusselldesign.wordpress.com/2012/06/25/using-fibonacci-for-game-balance/)
### 电子文档
* [Advanced Randomness Techniques for Game AI](http://www.gameaipro.com/GameAIPro/GameAIPro_Chapter03_Advanced_Randomness_Techniques_for_Game_AI.pdf) (pdf)
### 视频资料
* [Vectors & Dot Product • Math for Game Devs [Part 1]](https://www.youtube.com/watch?v=MOYiVLEnhrw)
* [Spaces & Cross Product • Math for Game Devs [Part 2]](https://www.youtube.com/watch?v=XiwEyopOMqg)
* [How I Made The World with SINE](https://www.youtube.com/watch?v=u1pRapBEHlU)
