<h2 align="center">服务端中间件</h2>
<p>
游戏开发中，服务端技术跟其它领域会有更大的相通性。有很多可复用的中间件能帮助开发提高效率和稳定性。
</p>

**关键词:**<br/>
*日志,服务发现,消息队列,Kafka,RabbitMQ,ElasticSearch,Consul,etcd*

**标签:**<br/>
*等级: 中级, 阶段: 学习|开发, 分类: 技术能力, 角色: 服务端开发*

----
## 消息队列

### 是什么？在哪用？

### 作用

- **解耦**
  - **作用**：让业务子模块更独立，更灵活

- **异步消息**
  - **作用**：业务之间不会相互阻塞等待，让各个系统运转更高效、顺畅

- **流量削锋**
  - **作用**：可更有效、更灵活的应对流量的激增

- **消息通迅**
  - **作用**：让各个业务模块之间可以便捷的通讯

### 应用

### 是什么？在哪用？

- **各个游戏系统/模块做成独立服务的时候，可以使用消息队列进行通信**

### 候选

### 是什么？在哪用？

- **Kafka**：高吞吐量的分布式消息队列

- **ActiveMQ**：Apache的消息中间件

- **RabbitMQ**：成熟可靠的开源消息队列

- **RocketMQ**：阿里巴巴开源的分布式消息中间件

### 会遇到哪些问题？

- **消息队列选择**
  - **问题**：不同消息队列有不同的特点和适用场景
  - **解决方向**：根据项目需求、性能要求、可靠性要求等因素选择合适的消息队列

## 数据日志与分析

### 是什么？在哪用？

### 作用

- **记录跟踪游戏中的数据，用以分析各种问题，比如网络问题、游戏问题、运营问题等等**

### 应用

### 是什么？在哪用？

- **收集并分析游戏数据**

### 举例

- **网络**
  - **网络异常记录**：记录网络连接异常、超时等问题

- **游戏系统**
  - **异常报错**：记录系统异常和错误信息
  - **流程打点**：记录关键流程的执行情况

- **游戏功能**
  - **功能入口计数**：统计功能使用频率
  - **玩法失败率**：分析玩法难度和体验
  - **活动参与率**：评估活动效果

- **运营**
  - **激活**：新用户激活数据
  - **留存**：用户留存率分析

### 技术考量

### 会遇到哪些问题？用什么解决？

### 数据规模

- **问题**：不同的数据规模，需要考虑不同的实现方案
- **解决方向**：
  - **数据规模不大**：可以考虑直接写文件或者数据库，比如SQL数据库或者MongoDB
  - **数据规模比较大**：就要考虑使用搜索和数据分析引擎

### 数据上报

- **问题**：考虑并发大量数据上报的问题
- **解决方向**：
  - **客户端上报/服务端上报**：选择合适的上报方式
  - **考虑上报的数据量和负载**：控制上报频率和数据量
  - **客户端上报不要影响游戏业务和体验**：异步上报，避免阻塞
  - **服务端上报不要影响游戏业务**：使用独立的上报服务

### 数据存储

- **问题**：数据持续增长，考虑旧数据的处理
- **解决方向**：制定数据归档策略，定期清理或归档旧数据

### 数据分析

### 是什么？在哪用？

- **需求**：
  - **查询**：支持灵活的数据查询
  - **统计**：支持数据统计和分析

- **工具**：
  - **要能让运营人员进行数据分析（运营人员是无法直接操作日志文件或者数据表的）**
  - **直接导出Excel**：方便运营人员使用
  - **Web分析后台**：提供可视化的数据分析界面

### 候选

### 是什么？在哪用？

- **ThinkingData**：专业的数据分析平台

- **Elastic Search**：强大的搜索和数据分析引擎

### 会遇到哪些问题？

- **数据分析工具选择**
  - **问题**：不同工具有不同的特点和适用场景
  - **解决方向**：根据数据规模、分析需求、成本等因素选择合适的工具

## 服务发现

### 是什么？在哪用？

### 作用

- **简化配置，通过发现服务，就能找到任意的服务模块**
- **了解所有服务的运行状态**

### 功能

### 是什么？在哪用？

- **服务发现**：自动发现和注册服务

- **健康检查**：监控服务健康状态

- **键值对存储**：存储配置信息

### 应用

### 是什么？在哪用？

- **API网关**：作为API网关的服务注册中心

### 候选

### 是什么？在哪用？

- **Consul**：HashiCorp开发的服务发现和配置管理工具

- **etcd**：分布式键值存储系统，常用于Kubernetes

- **zookeeper**：Apache的分布式协调服务

### 会遇到哪些问题？

- **服务发现工具选择**
  - **问题**：不同工具有不同的特点和适用场景
  - **解决方向**：根据架构需求、性能要求、运维复杂度等因素选择合适的工具

## 更多资料