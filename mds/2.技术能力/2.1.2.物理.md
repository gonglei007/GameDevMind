<h2 align="center">物理</h2>
<p>
真实的物理表现会给游戏带来真实的体验感。我们来看一下游戏开发中的物理所要考虑的一些事情。
</p>

**关键词:**<br/>
*刚体,碰撞体,Collider,触发器,Trigger,力,软体,AABB,Physx,Bullet,Havok*

**标签:**<br/>
*等级: 中级, 阶段: 学习|开发, 分类: 技术能力, 角色: 客户端开发|美术*

----
## 刚体

### 是什么？在哪用？

- **作用**：
  - 表现物体的质量
  - 表现物体的碰撞

- **属性**：
  - **质量**：影响物体的惯性和受力响应
  - **弹性**：影响碰撞后的反弹程度

## 速度

### 是什么？在哪用？

- **作用**：让物体获得一个速度

- **特性**：
  - 速度是个向量
  - 速度会受到碰撞和力的影响

## 力与加速度

### 是什么？在哪用？

### 加速度来源

- **施加在刚体上的力产生加速度**：通过施加力来改变物体的运动状态

- **全局加速度**
  - **重力**
    - **作用**：提供一个全局的方向统一的力

### 应用举例

- **粒子系统**：可用在粒子系统中粒子的表现

- **自然系统**：可用在自然系统的事物的表现。例如随风飘落的雪花

- **汽车的驱动**：模拟车辆的动力系统

- **抛出去的物体**：模拟抛射物的运动轨迹

- **物体在水中行进的阻力表现**：模拟流体阻力

## 碰撞

### 是什么？在哪用？

### 碰撞体（Collider）

- **作用**：产生物理阻挡、碰撞效果

### 触发器（Trigger）

- **作用**：用于检测到物体发生接触或者交叉了

### 碰撞检测模式

### 是什么？在哪用？

- **Discrete（离散检测）**
  - **优点**：性能好
  - **问题**：物体速度较快时可能会穿过另一碰撞物体

- **Continuous（连续检测）**
  - **说明**：连续的碰撞检测，保证物体不会穿过其它碰撞体。但性能较低

- **Continuous dynamic（连续动态检测）**
  - **应用**：针对静态网格碰撞器（不带刚体），用于快速移动的物体

### 会遇到哪些问题？用什么解决？

- **快速移动物体穿透**
  - **问题**：两个快速移动的碰撞体，可能会相互穿过而检测不到碰撞。这是因为两帧计算碰撞体已经错过了相交位置
  - **解决方向**：这个情况可以通过设置碰撞检测模式来处理

### 算法

### 是什么？在哪用？

- **AABB（Axis-Aligned Bounding Box）**
  - **说明**：简单的说是通过物体的矩形（立方体）外框作为碰撞检测判断的过滤方法，这个AABB框没有碰撞，就先不检查物体的细节碰撞
  - **应用**：作为粗检测，提高碰撞检测性能

### 优化

### 会遇到哪些问题？用什么解决？

- **性能问题**
  - **碰撞模式**
    - **问题**：不同的碰撞模式（CPU）性能差别非常大
    - **解决方向**：要做好平衡，根据实际需求选择合适的碰撞检测模式

  - **空间分割**
    - **方法**：预知的不可能相互碰撞的物体置入不同的分组中，碰撞检测时就不用对这两个分组中的物体进行碰撞运算，以节省大量的运算

  - **选择中间件**
    - **说明**：不同的中间件可能会有不同的硬件加速支持，可以根据产品所运行的平台，游戏的物理内容，来选择适合的中间件来实现物理表现

## 物理材质

### 是什么？在哪用？

### 摩擦力

- **静摩擦**：物体静止时的摩擦力
- **动摩擦**：物体运动时的摩擦力

### 弹性系数（Bounciness）

### 是什么？在哪用？

- **作用**：决定反弹的"程度"，比如铁球的反弹系数较低，皮球的反弹系数较高

## 射线

### 是什么？在哪用？

### 应用举例

- **射击游戏中的射击目标检测**：检测子弹是否命中目标

- **鼠标、光标在3D场景中的点击拾取**：检测鼠标点击的3D位置

## 阻尼振动

### 是什么？在哪用？

- **说明**：阻尼振动是指，由于振动系统受到摩擦和介质阻力或其他能耗而使振幅随时间逐渐衰减的振动，又称减幅振动、衰减振动

### 应用举例

- **赛车游戏中的跟随摄像机**
  - **问题**：如果生硬的绑定在车子的后面，会体验会很不好
  - **解决**：如果车子在加速和减速的时候，跟随摄像机有一定加减速和阻尼振动，会让体验更自然

## 约束

### 是什么？在哪用？

- **作用**：将多个物体（刚体）连接在一起

- **特性**：有的物理引擎中，超过一定的力，可以破坏掉约束

### 应用

- **关节的效果**：模拟人体关节、机械关节等

- **机械的衔接部件**：模拟机械连接

## 软体

### 是什么？在哪用？

### 应用举例

- **在游戏中实现类似绳子、虫子、果冻等物体的效果**

## 候选中间件

### 是什么？在哪用？

### Physx

- **优势**：在一些设备上有硬件加速

### Bullet

- **优势**：免费

### Havok

- **优势**：比较完善的商业物理引擎

### 会遇到哪些问题？

- **中间件选择**
  - **问题**：不同中间件有不同的特点和适用场景
  - **解决方向**：根据项目需求、目标平台、性能要求、成本等因素选择合适的物理引擎

## 更多资料

### 讲义资料
* [Physically Based Modeling: Principles and Practice](https://www.cs.cmu.edu/~baraff/sigcourse/)

### 论文资料
* [Advanced Character Physics](https://www.cs.cmu.edu/afs/cs/academic/class/15462-s13/www/lec_slides/Jakobsen.pdf)

### 在线文章
* [Game Physics: Broadphase – Dynamic AABB Tree](https://allenchou.net/2014/02/game-physics-broadphase-dynamic-aabb-tree/) - 本文解释了动态 AABB 树的工作原理，并展示了示例实现。

### 视频资料
* [Building a Physics Engine with C++ and Simulating Machines](https://www.youtube.com/watch?v=TtgS-b191V0)
* [Let's talk about physics engines in games](https://www.youtube.com/watch?v=obGMhUvq5pg)
