<h2 align="center">图形与渲染</h2>
<p>
跟游戏图形渲染相关的事情。
</p>

**关键词:**<br/>
*图形,渲染,光照,材质,贴图,摄像机,Mesh,Shader,OpenGL,DirectX,Vulkan,Metal*

----
## 摄像机（Camera）

### 是什么？在哪用？

- **正交**
  - **应用**：通常用于2D游戏或者UI界面

- **透视**
  - **特点**："近大远小"，让画面有纵深感
  - **应用**：3D游戏场景

- **近截面、远截面**
  - **作用**：定义可见范围，裁剪超出范围的对象

- **剔除**
  - **作用**：不渲染摄像机视野外的对象，提高性能

## 3D

### Mesh

### 是什么？在哪用？

- **顶点**
  - **数据类型决定精度和数据大小**
  - **数据**：
    - **vertex**：顶点的坐标数据
    - **color**：顶点颜色数据
      - **应用**：通常用于静态光照，也可用于多层贴图混合
    - **normal**：顶点的法线数据
      - **作用**：当光线照射到这个顶点后，反射光线往那边去
    - **uv**：顶点的UV数据
      - **作用**：这个顶点绑定到了贴图上的哪个坐标位置

- **边**
  - **说明**：两个顶点组成了一个边

- **面**
  - **方向**：
    - **单向**：单向的面，性能更优，但只有一个方向是可见的
    - **双向**：两个方向都可见

- **索引列表**
  - **说明**：多边形是有方向的，Index的顺序决定面的方向

- **平滑组**
  - **作用**：用来定义面分组，来影响面和面之间的平滑（光影）关系。通常它只是在编辑期和存储期使用，给运行时使用之前，会通过它给每个面（顶点）算出法线方向

### Object/Model

### 是什么？在哪用？

- **Transformation**
  - **Transform**：位置变换
  - **Rotation**：旋转变换
  - **Scale**：缩放变换

### 裁剪

### 是什么？在哪用？

- **作用**：为了性能，尽量减少摄像机中不可见的面的提交

### 数学

### 是什么？在哪用？

- **坐标**
  - **左手坐标系/右手坐标系**：不同的引擎、工具可能采用不同的坐标系

- **法向**
  - **应用**：用来计算光线反射的方向

- **切向**
  - **应用**：用于法线贴图等高级渲染技术

## 2D

### Sprite

### 是什么？在哪用？

- **贴图使用**
  - **说明**：为了优化存储、内存、运行效率，通常会把一个一个图片元素组合进一个大的贴图中，共用一个材质，运行是通过UV来确定sprite显示的区域

- **帧动画**
  - **特点**：
    - 更多的资源
    - 相对细腻的表现

- **骨骼动画**
  - **特点**：
    - 更少的资源
    - 相对粗的表现（有时也是一种风格）

- **行为表现**
  - **应用**：淡入、淡出、翻转、按指定轨迹运动等

## 贴图（Texture）

### 是什么？在哪用？

- **作用**：为游戏中的元素的颜色显示或者运算提供颜色输入。例如，模型表面的图像，用于运算材质的颜色，用户界面上的图像等等

### 数据格式

### 是什么？在哪用？

- **压缩**
  - **特点**：让包体更小，但加载更慢

- **非压缩**
  - **特点**：加载更快，但包体较大

### 压缩格式

### 是什么？在哪用？

- **DXTC**：DirectX纹理压缩格式
- **ETC**：Android平台常用
- **ASTC**：现代移动平台支持的高质量压缩格式

### 纹理映射

### 是什么？在哪用？

- **作用**：将2D贴图映射到3D模型表面

### 贴图坐标偏移

### 是什么？在哪用？

- **应用**：可用于贴图动画

### 会遇到哪些问题？

- **设备限制**
  - **问题**：不同的设备对渲染用贴图的尺寸有所限制
  - **举例**：
    - 如某些设备上要求贴图宽高是2的幂
    - 有些设备将最大尺寸限制到2048*2048
  - **解决方向**：具体限制请查看文档，根据目标平台选择合适的贴图尺寸

### Mipmap

### 是什么？在哪用？

- **作用**：
  - 如果场景有纵深，mipmap可让远处贴图看着不"花"（这是由多个贴图像素投影到同一个屏幕像素上造成的）
  - 并且可提高渲染性能

### 优化

### 会遇到哪些问题？用什么解决？

- **贴图优化**
  - **建议**：
    - 可使用24位色（无半透）的就不要使用32位色
    - 可使用压缩格式（3D物体）的就不要使用非压缩格式
    - 颜色简单的可使用索引色

## 材质（Material）

### 是什么？在哪用？

- **作用**：材质是用来影响物体表现的，比如光照在物体上的表现

### Diffuse

### 是什么？在哪用？

- **作用**：光源和物体面片的直接光照计算

### Normal Map

### 是什么？在哪用？

- **作用**：表现物体表面的反光

### Specular

### 是什么？在哪用？

- **说明**：
  - 高光颜色可以表现在某个方向反射的入射光线多少。高光反应在您的眼睛与反射的入射光线的方向对齐的时候是最亮的，所以高光是根据视图进行变化的
  - 法线也会影响高光，因为它会影响反射的光源方向。高光强度可以控制表全面的光泽或光泽程度。非常高的高光强度可以表现如镜面一般的表面，而低强度可以表现比较粗糙的表面

### Bump Map

### 是什么？在哪用？

- **作用**：表现物体表面的凹凸感

## 光照（Light）

### 是什么？在哪用？

- **动态光照**
  - **说明**：针对运动的物体或者光源，实时变化的光照
  - **应用**：移动的物体、动态光源场景

- **静态光照**
  - **说明**：预先烘焙好的光照
  - **LightMap**：静态光照贴图，提高性能

### 光源类型

### 是什么？在哪用？

- **点光**
  - **特点**：点光向所有方向发光，可以表现灯泡的效果

- **方向光**
  - **特点**：方向光是平行光，可以表现出太阳光的效果

- **聚光灯**
  - **特点**：可以表现出舞台上聚光灯的效果

- **全局光/环境光**
  - **特点**：照亮整个场景，无方向（或者说来自四面八方）

- **区域光**
  - **应用**：模拟面光源效果

- **体积光**
  - **应用**：表现光束效果

### 自发光

### 是什么？在哪用？

- **作用**：物体自身发光，不受其他光源影响

### 光线追踪

### 是什么？在哪用？

- **反射**
  - **应用**：实现真实的光线反射效果

### 会遇到哪些问题？用什么解决？

- **性能优化**
  - **问题**：动态光照计算量大，影响性能
  - **解决方向**：尽量减少同时激活的动态光源的数量以提高渲染性能

## 渲染（Render）

### 是什么？在哪用？

### 固定渲染管线

- **流程**：
  - 顶点着色器
  - 细分着色器
  - 几何着色器
  - 图元装配
  - 剪切
  - 光栅化
  - 片元着色器
  - 测试与混合

### 可编程管线

### 是什么？在哪用？

- **着色器（Shader）**
  - **vs（顶点着色器）**：处理顶点数据
  - **ps（片元着色器）**：处理像素颜色
  - **Post Processing**：后处理效果

### 深度缓存

### 是什么？在哪用？

- **说明**：也叫"Z-Buffer"
- **作用**：存储多边形上的点的深度信息，也就是距离"眼睛"的距离，可以通过它知道物体的前后关系
- **应用举例**：
  - 透视效果
  - 描边
  - 表面扭曲

### 深度测试

### 是什么？在哪用？

- **作用**：比较空间中的点距离摄像机的远近关系
- **应用**：处理遮挡关系

### 蒙版测试

### 是什么？在哪用？

- **作用**：相当于给映射的内容打标记，然后根据标记来决定颜色如何处理
- **应用**：
  - 抠图
  - 阴影

### Alpha混合

### 是什么？在哪用？

- **作用**：半透明的程度

### Alpha测试

### 是什么？在哪用？

- **作用**：根据Alpha值决定是否渲染像素

### 抗锯齿

### 是什么？在哪用？

- **作用**：减少图形边缘的锯齿，提高画面质量

## 图形渲染接口

### 是什么？在哪用？

### OpenGL

- **特点**：
  - 跨平台
  - 支持的系统比较多
- **主要系统**：
  - 几个主要的电脑操作系统
  - PS系列游戏机

### DirectX

- **说明**：微软的图形接口
- **主要系统**：
  - Windows
  - XBox系列游戏机

### Vulkan

- **说明**：由Khronos Group组织提供的非常新的接口
- **特点**：
  - 高性能
  - 可扩展性
- **主要系统**：
  - Windows，Linux和Android

### Metal

- **说明**：由Apple开发的图形接口
- **特点**：
  - 低延迟
  - 高性能
- **主要系统**：
  - iOS和macOS

## 颜色

### 是什么？在哪用？

### 格式

- **RGBA**：红绿蓝透明度
- **CMYK**：青品黄黑，用于印刷

### 索引色

### 是什么？在哪用？

- **作用**：更节省存储空间

### 颜色范围

### 是什么？在哪用？

- **说明**：不同颜色空间有不同的颜色范围，影响显示效果

## 更多资料

### 在线资料
* [Beginning Game Programming v2.0](https://lazyfoo.net/tutorials/SDL/)
* [Learn OpenGL](https://learnopengl.com/)
* [uv-game.com](https://uv-game.com/intro)
* [计算机图形学与混合现实在线平台](http://games-cn.org/)

### 文章
* [从转系生到终身教授：十二年图形学物理模拟的自我回顾](https://zhuanlan.zhihu.com/p/560415998)

### 视频资料
* [Code-It-Yourself! 3D Graphics Engine Part #1 - Triangles & Projection](https://www.youtube.com/watch?v=ih20l3pJoeU)
* [Code-It-Yourself! 3D Graphics Engine Part #2 - Normals, Culling, Lighting & Object Files](https://www.youtube.com/watch?v=XgMWc6LumG4)
* [Code-It-Yourself! 3D Graphics Engine Part #3 - Cameras & Clipping](https://www.youtube.com/watch?v=HXSuNxpCzdM)
* [Code-It-Yourself! 3D Graphics Engine Part #4 - Texturing & Depth Buffers](https://www.youtube.com/watch?v=nBzCS-Y0FcY)