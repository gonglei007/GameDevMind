<h2 align="center">版本管理</h2>
<p>
在产品的开发和运营过程中，特别是对大的产品和项目，可能会有大量的分支、版本存在。有效的管理好版本，会让项目不陷入混乱，不影响整体效率。版本管理包括版本控制系统、分支管理、资源组织等方面。
</p>

**关键词:**<br/> 
*git,分支,版本控制,分支管理,资源管理,热更新*

**标签:**<br/>
*等级: 初级|中级, 阶段: 开发, 分类: 管理能力, 角色: 客户端开发|服务端开发|全栈开发|管理*

## 图谱

## 目录

- [解决的问题](#解决的问题)
- [版本控制系统](#版本控制系统)
- [分支管理](#分支管理)
- [资源组织](#资源组织)
- [更多资料](#更多资料)

----

## 解决的问题

**解决问题：**
- **做好分支的规划：** 合理规划分支结构，避免分支混乱
- **做好分支定期的合并工作：** 定期合并分支，避免长时间不合并导致合并困难
  - **长时间不合并的分支将变得非常难以合并：** 分支差异越大，合并冲突越多，解决成本越高
- **处理好大文件的版本管理：** 游戏开发中经常有大文件（美术资源、音频等），需要特殊处理

## 版本控制系统

**是什么？在哪用？**

- **作用**：用于管理代码和资源的版本历史，支持团队协作和版本回溯
- **应用场景**：
  - 所有需要版本管理的项目
  - 多人协作的项目
  - 需要版本回溯的项目
  - 需要管理代码和资源的项目
- **做什么的？** 用于管理代码和资源的版本历史，支持团队协作和版本回溯。
- **在哪用？** 所有需要版本管理的项目，特别是多人协作的项目。

**会遇到哪些问题？用什么解决？**

- **如何选择合适的版本控制系统？**
  - **问题**：需要选择合适的版本控制系统
  - **解决方向**：
    - **让工程资源有效管理，保障团队协作和分享：通过版本控制系统，团队成员可以协作开发，共享资源，回溯历史：** 版本控制作用
      - 协作开发
      - 共享资源
      - 回溯历史
    - **概念：** 版本控制概念
      - **中心式：** 中心式版本控制
        - **上传（submit）：将本地更改提交到中心服务器：** 上传操作
          - 提交到中心服务器
        - **更新（update）：从中心服务器获取最新版本：** 更新操作
          - 获取最新版本
      - **分布式：** 分布式版本控制
        - **提交（commit）：在本地仓库记录更改：** 提交操作
          - 本地记录更改
        - **推送（push）：将本地更改推送到远程仓库：** 推送操作
          - 推送到远程仓库
        - **拉取（pull）：从远程仓库获取最新更改：** 拉取操作
          - 获取最新更改
      - **通用：** 通用概念
        - **分支（branch）：** 分支概念
          - **作用：开分支，让不同的工作任务独立完成，不会被互相影响和干扰：** 分支作用
            - 独立完成任务
            - 避免互相影响
        - **标签（tag）：** 标签概念
          - **应用场景：当有版本（特别是正式版）发布的时候，要考虑打上tag，将来针对发布了的某个版本来查看问题，就能快速的找到这个版本的内容：** 标签应用
            - 版本发布时打tag
            - 快速找到版本内容
        - **签出（checkout）：切换到指定的分支或版本：** 签出操作
          - 切换分支或版本
        - **合并（merge）：将不同分支的更改合并到一起：** 合并操作
          - 合并分支更改
    - 评估项目需求
    - 考虑团队规模
    - 考虑文件大小
    - 考虑协作方式

- **如何组织代码和资源？**
  - **问题**：需要组织代码和资源
  - **解决方向**：
    - 建立清晰的目录结构
    - 分离代码和资源仓库
    - 建立命名规范
    - 建立组织规范

- **如何处理大文件？**
  - **问题**：需要处理大文件
  - **解决方向**：
    - 使用专门的大文件管理工具（如Perforce、Git LFS）
    - 分离大文件到独立仓库
    - 使用文件服务器管理大文件
    - 优化大文件存储策略

**要点和思考方向：**
- 版本控制系统是团队协作的基础工具
- 通过版本控制系统实现协作开发、共享资源、回溯历史
- 选择合适的版本控制系统根据项目需求
- 合理组织代码和资源，建立清晰的目录结构
- 使用专门工具处理大文件，避免影响版本控制性能

## 分支管理

**是什么？在哪用？**

- **作用**：通过分支策略管理不同功能的开发和发布流程
- **应用场景**：
  - 需要并行开发多个功能时
  - 需要维护多个版本时
  - 需要隔离开发时
- **做什么的？** 通过分支策略管理不同功能的开发和发布流程。
- **在哪用？** 需要并行开发多个功能或需要维护多个版本的项目。

**会遇到哪些问题？用什么解决？**

- **如何规划分支结构？**
  - **问题**：需要规划分支结构
  - **解决方向**：
    - **解决问题：**
      - **做好分支的规划：合理规划分支结构，避免分支混乱：** 分支规划
        - 合理规划结构
        - 避免分支混乱
    - **常见分支：** 分支类型
      - **主分支：主要用于协调各个分支，较少直接在上面开发提交。最后开发稳定的内容合并到主分支和制作正式版本：** 主分支
        - 协调各个分支
        - 合并稳定内容
        - 制作正式版本
      - **开发分支：建议做一些"小步快跑"的"小"事情的开发：** 开发分支
        - 小步快跑
        - 小事情开发
      - **功能分支：开发周期稍长，开发过程中不希望影响到别人的开发，也不希望被别人的开发影响：** 功能分支
        - 开发周期长
        - 隔离开发
      - **（热）修复分支：通常来从"主分支"分出，用于给一些稳定版本临时修复bug：** 修复分支
        - 从主分支分出
        - 临时修复bug
      - **发布分支：有些更精细的分支管理，会有一个发布分支，用于发布"开发分支"中的相对稳定的版本内容，测试后之后再合进"主分支"：** 发布分支
        - 发布稳定版本
        - 测试后合并
    - **分支规划：** 规划策略
      - **功能开发：在一个阶段性开发中，如果是一个相对大的复杂的功能，建议为这个功能开发从开发分支开出来一个分支来制作，完成后合并回去：** 功能开发分支
        - 从开发分支分出
        - 完成后合并
      - **问题修复：如果是针对线上版本做的小修复，可以从"主分支"开出来"（热）修复分支"，修复好后合回主分支：** 问题修复分支
        - 从主分支分出
        - 修复后合并
      - **建议：具体的分支规划，也要看项目和团队的规模。如果是大的项目，分支规划会更复杂；如果是小的项目，有些分支也可以被精简掉：** 规划建议
        - 根据项目规模
        - 根据团队规模
        - 灵活调整
    - 根据项目规模选择分支策略
    - 建立分支命名规范
    - 建立分支管理流程

- **何时创建新分支？**
  - **问题**：需要确定何时创建新分支
  - **解决方向**：
    - 功能开发时创建功能分支
    - 问题修复时创建修复分支
    - 发布版本时创建发布分支
    - 根据开发需求灵活创建

- **如何避免合并冲突？**
  - **问题**：需要避免合并冲突
  - **解决方向**：
    - **解决问题：**
      - **做好分支定期的合并工作：定期合并分支，避免长时间不合并导致合并困难：** 定期合并
        - 定期合并分支
        - 避免合并困难
        - **长时间不合并的分支将变得非常难以合并：分支差异越大，合并冲突越多，解决成本越高：** 合并困难
          - 分支差异大
          - 合并冲突多
          - 解决成本高
    - **分支合并：** 合并策略
      - **建议：** 合并建议
        - **尽量频繁的去合并分支，长时间没有合并的分支，合并起来会非常困难：定期合并可以减少冲突，降低合并成本：** 频繁合并
          - 频繁合并
          - 减少冲突
          - 降低合并成本
        - **低耦合、高内聚的系统设计，也会有利于分支合并：良好的代码结构可以减少合并冲突：** 代码结构
          - 低耦合
          - 高内聚
          - 减少合并冲突
    - 定期合并分支
    - 保持代码结构良好
    - 及时解决冲突
    - 建立合并检查机制

**要点和思考方向：**
- 分支管理是并行开发的基础
- 合理规划分支结构，避免分支混乱
- 定期合并分支，避免长时间不合并导致合并困难
- 根据项目规模灵活调整分支策略
- 保持良好的代码结构有利于分支合并

## 资源组织

**是什么？在哪用？**

- **作用**：组织和管理不同类型的资源，包括代码、数字资源等
- **应用场景**：
  - 所有需要管理多种类型资源的项目
  - 需要管理代码和资源的项目
  - 需要管理大文件的项目
- **做什么的？** 组织和管理不同类型的资源，包括代码、数字资源等。
- **在哪用？** 所有需要管理多种类型资源的项目。

**会遇到哪些问题？用什么解决？**

- **如何组织代码和资源？**
  - **问题**：需要组织代码和资源
  - **解决方向**：
    - **解决问题：**
      - **处理好大文件的版本管理：游戏开发中经常有大文件（美术资源、音频等），需要特殊处理：** 大文件管理
        - 处理大文件
        - 特殊处理
    - **代码：** 代码组织
      - **仓库举例：** 代码仓库
        - **客户端工程：客户端代码仓库：** 客户端仓库
          - 客户端代码
        - **服务端工程：服务端代码仓库：** 服务端仓库
          - 服务端代码
    - 建立清晰的目录结构
    - 分离代码和资源仓库
    - 建立命名规范

- **如何处理大文件？**
  - **问题**：需要处理大文件
  - **解决方向**：
    - **数字资源：** 数字资源管理
      - **说明：美术资源、声音资源、场景资源等：** 资源类型
        - 美术资源
        - 声音资源
        - 场景资源
      - **推荐工具：** 大文件工具
        - **Perforce：适合管理大文件的版本控制系统：** Perforce
          - 适合大文件
          - 版本控制系统
        - **或者git lfs：Git Large File Storage，Git的大文件扩展：** Git LFS
          - Git大文件扩展
      - **仓库举例：** 资源仓库
        - **美术仓库：存放美术资源：** 美术仓库
          - 美术资源
        - **策划仓库：存放策划相关资源：** 策划仓库
          - 策划资源
        - **数据配表仓库：存放游戏配置数据：** 配表仓库
          - 配置数据
    - 使用专门的大文件管理工具
    - 分离大文件到独立仓库
    - 优化大文件存储策略

- **如何实现自动化管理？**
  - **问题**：需要实现自动化管理
  - **解决方向**：
    - **热更新：** 热更新管理
      - **说明：跟CI工具、构建工具配合，可实现自动化的热更数据管理。可以参考 [4.3.3.DevOps](../4.生产能力/4.3.3.DevOps.md) 中的持续集成相关内容：** 自动化热更
        - CI工具配合
        - 构建工具配合
        - 自动化管理
    - 使用CI/CD工具实现自动化
    - 建立自动化流程
    - 实现自动化构建和发布

**要点和思考方向：**
- 资源组织是版本管理的重要组成部分
- 合理组织代码和资源，建立清晰的目录结构
- 使用专门工具处理大文件，避免影响版本控制性能
- 实现自动化管理提高效率
- 分离不同类型的资源到独立仓库便于管理

## 更多资料
* [45 个 Git 经典操作场景，专治不会合代码](https://zhuanlan.zhihu.com/p/485010145)